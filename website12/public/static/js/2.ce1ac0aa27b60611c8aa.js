webpackJsonp([2],{"6orE":function(t,e,a){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,l=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(l.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new n(l.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a("qrAv"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,a("h6ac"))},FqOg:function(t,e){},cTEx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("T4f3"),l=a.n(i),n=a("aKwh"),s=a("fOL2"),o=a("gyMJ"),c=a("6orE"),r={props:{toolbars:{type:Object,default:function(){return{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}}},data:function(){return{isUpload:!1,dialogVisible:!1,selectValue:[],info:{},drafts_id:"",uploadDisabled:!1,extraData:{token:window.sessionStorage.getItem("token"),article_id:Object(s.a)(),article_author:this.$store.state.username,article_title:"",article_time:(new Date).toLocaleString().replace(/\//g,"-"),tags_id:"",article_introduce:this.content2},content1:"",content2:"",title:"",token:window.sessionStorage.getItem("token")}},created:function(){var t=this;this.$store.dispatch("getTags"),this.$store.dispatch("getDraft"),this.timer=setInterval(function(){t.$store.dispatch("saveDraft",t.articleValue)},2e4)},computed:l()({},Object(n.c)(["tags","username","articleInfo","draft","articleValue"]),{articleValue:{get:function(){return this.$store.state.articleValue},set:function(t){return this.$store.commit("SET_ARTICLE_VALUE",t)}}}),methods:{$imgAdd:function(t,e){var a=this;o.a.uploadArticleImg(l()({},e)).then(function(i){i.code&&a.$store.commit("SET_ARTICLE_VALUE",a.articleValue.replace("!["+e._name+"]("+t+")","!["+e._name+"]("+i.data+")"))}).catch(function(t){console.log(t)})},$save:function(t,e){""!==t?(this.info={article_id:Object(s.a)(),article_title:this.title,article_content:t,article_img:"",article_author:this.username,article_assist:0,article_read:0,article_introduce:this.content1,article_time:(new Date).toLocaleString().replace(/\//g,"-")},this.dialogVisible=!0):this.$notify({title:"警告",message:"请编辑内容",type:"warning"})},SelectClose:function(){var t=this;this.dialogVisible&&(this.info.article_title&&this.selectValue&&"Number"!==this.info.article_title?(this.info.tags_id=this.tags.find(function(e){return e.tags_name===t.selectValue}).tags_id,this.$store.dispatch("writeArticle",this.info),this.dialogVisible=!1):this.$notify.warning({message:"标题或标签不能为空",offset:150}))},submitUpload:function(){this.$refs.upload.submit(),this.extraData.article_introduce=this.content2,this.extraData.article_id=Object(s.a)()},beforeUpload:function(t){},fileChange:function(t,e){var a=this;this.uploadDisabled=!1,"ready"===t.status&&"text/markdown"!==t.raw.type&&(this.uploadDisabled=!0,this.$notify.warning({message:"必须上传markdown格式文件,请取消文件上传",offset:150}),e.clearFiles()),""!==this.selectValue&&(this.extraData.tags_id=this.$store.state.tags.find(function(t){return t.tags_name===a.selectValue}).tags_id)},fileSuccess:function(t,e,a){t.code?(this.$notify.success({message:t.msg,offset:150}),this.$store.dispatch("getArticleList")):this.$notify.error({message:t.msg,offset:150})}},activated:function(){},deactivated:function(){},beforeDestroy:function(){Object(c.clearInterval)(this.timer)}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"write"},[a("div",{staticClass:"Breadcrumb"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("文章管理")]),t._v(" "),a("el-breadcrumb-item",[t._v("发布文章")])],1)],1),t._v(" "),a("div",{staticClass:"upload"},[a("h1",{staticStyle:{"font-size":"30px","font-weight":"200","margin-bottom":"10px"}},[t._v("上传发布")]),t._v(" "),a("el-button",{staticStyle:{display:"block","margin-bottom":"10px"},attrs:{size:"small",type:"success",disabled:t.uploadDisabled},on:{click:t.submitUpload}},[t._v("选择完成上传")]),t._v(" "),a("el-select",{staticStyle:{"margin-bottom":"10px"},attrs:{clearable:"",placeholder:"请选择标签"},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}},t._l(t.tags,function(t){return a("el-option",{key:t.tags_id,attrs:{label:t.tags_name,value:t.tags_name}})})),t._v(" "),a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入标题",clearable:""},model:{value:t.extraData.article_title,callback:function(e){t.$set(t.extraData,"article_title",e)},expression:"extraData.article_title"}}),t._v(" "),a("el-input",{staticStyle:{"margin-top":"10px",width:"90%"},attrs:{type:"textarea",rows:5,placeholder:"文章简介"},model:{value:t.content2,callback:function(e){t.content2=e},expression:"content2"}}),t._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"http://127.0.0.1:3000/admin/uploadArticle","auto-upload":!1,multiple:"","on-change":t.fileChange,"on-success":t.fileSuccess,data:t.extraData,"before-upload":t.beforeUpload}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")]),t._v("(只能上传md文件)")])])],1),t._v(" "),a("h1",{staticStyle:{"font-size":"30px","font-weight":"200","margin-bottom":"10px"}},[t._v("直接发布")]),t._v(" "),a("el-input",{staticStyle:{width:"50%","margin-bottom":"10px"},attrs:{placeholder:"请输入文章标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),a("el-input",{staticStyle:{width:"50%","margin-bottom":"20px"},attrs:{type:"textarea",rows:5,placeholder:"文章简介"},model:{value:t.content1,callback:function(e){t.content1=e},expression:"content1"}}),t._v(" "),a("mavon-editor",{staticStyle:{height:"100%"},attrs:{boxShadow:!0,toolbars:t.toolbars},on:{imgAdd:t.$imgAdd,save:t.$save},model:{value:t.articleValue,callback:function(e){t.articleValue=e},expression:"articleValue"}}),t._v(" "),a("el-dialog",{attrs:{title:"选择标签",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"select-tag"},[a("el-select",{attrs:{multiple:!1,filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}},t._l(t.tags,function(t){return a("el-option",{key:t.tags_id,attrs:{label:t.tags_name,value:t.tags_name}})}))],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.SelectClose}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var d=a("/4AN")(r,u,!1,function(t){a("FqOg")},"data-v-4cc0bcb6",null);e.default=d.exports},qrAv:function(t,e,a){(function(t,e){!function(t,a){"use strict";if(!t.setImmediate){var i,l,n,s,o,c=1,r={},u=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){p(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}()?t.MessageChannel?((n=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){n.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(l=d.documentElement,i=function(t){var e=d.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,l.removeChild(e),e=null},l.appendChild(e)}):i=function(t){setTimeout(p,0,t)}:(s="setImmediate$"+Math.random()+"$",o=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&p(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",o,!1):t.attachEvent("onmessage",o),i=function(e){t.postMessage(s+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var l={callback:t,args:e};return r[c]=l,i(c),c++},f.clearImmediate=m}function m(t){delete r[t]}function p(t){if(u)setTimeout(p,0,t);else{var e=r[t];if(e){u=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(a,i)}}(e)}finally{m(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,a("h6ac"),a("pBGv"))}});
//# sourceMappingURL=2.ce1ac0aa27b60611c8aa.js.map